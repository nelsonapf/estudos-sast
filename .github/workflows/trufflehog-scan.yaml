name: TruffleHog Scan Test

on:
 pull_request:
   branches:
     - main

jobs:
 trufflehog:
   runs-on: ubuntu-latest

   steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Prepara TruffleHog
      run: |
        docker pull trufflesecurity/trufflehog:latest

    - name: Roda TruffleHog
      run: |
        docker run --rm -it -v "$PWD:/pwd" trufflesecurity/trufflehog:latest github --repo https://github.com/nelsonapf/estudos-sast